<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OSINT Database Search - Created by Happy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'JetBrains Mono', monospace; }
        .cyber-title { font-family: 'Orbitron', sans-serif; }
        .matrix-bg { background: linear-gradient(rgba(0,0,0,0.9), rgba(0,20,0,0.9)), repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,255,0,0.03) 2px, rgba(0,255,0,0.03) 4px); }
    </style>
</head>
<body class="matrix-bg min-h-screen text-green-400">
    <div id="app" class="container mx-auto px-4 py-8 max-w-6xl">
        <div class="text-center mb-12">
            <h1 class="cyber-title text-4xl md:text-5xl font-bold text-green-500 mb-4">OSINT DATABASE SEARCH</h1>
            <p class="text-green-600">‚ö†Ô∏è FOR EDUCATIONAL PURPOSES ONLY ‚ö†Ô∏è</p>
            <p class="text-sm text-green-700 mt-2">Created by Happy üíö</p>
        </div>
        
        <div class="bg-black/50 border-2 border-green-500 rounded-lg p-6 mb-8">
            <div class="mb-4">
                <label class="block text-green-400 mb-2 font-semibold">Phone Number:</label>
                <input type="text" id="phoneInput" placeholder="91xxxxxxxxxx" 
                    class="w-full bg-black/70 border-2 border-green-600 text-green-400 px-4 py-3 rounded focus:outline-none focus:border-green-400">
            </div>
            <button onclick="searchDatabase()" id="searchBtn"
                class="w-full bg-green-600 hover:bg-green-700 text-black font-bold py-3 rounded transition-colors">
                üîç SEARCH DATABASE
            </button>
        </div>

        <div id="results" class="hidden bg-black/50 border-2 border-green-500 rounded-lg p-6"></div>
        <div id="loading" class="hidden text-center text-green-400">
            <div class="animate-spin inline-block w-8 h-8 border-4 border-green-600 border-t-green-400 rounded-full"></div>
            <p class="mt-2">Searching...</p>
        </div>
    </div>

    <button onclick="toggleAdmin()" 
        class="fixed bottom-4 right-4 bg-green-600 hover:bg-green-700 text-black p-4 rounded-full">
        ‚öôÔ∏è
    </button>

    <div id="adminModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center p-4">
        <div class="bg-black border-2 border-green-500 rounded-lg p-6 max-w-md w-full">
            <div id="loginForm">
                <h2 class="text-xl font-bold text-green-400 mb-4">Admin Login</h2>
                <input type="password" id="adminPassword" placeholder="Password" 
                    class="w-full bg-black/70 border-2 border-green-600 text-green-400 px-4 py-2 rounded mb-4">
                <button onclick="adminLogin()" 
                    class="w-full bg-green-600 hover:bg-green-700 text-black font-bold py-2 rounded">
                    Login
                </button>
            </div>
            <div id="adminPanel" class="hidden">
                <h2 class="text-xl font-bold text-green-400 mb-4">Admin Panel</h2>
                <button onclick="logout()" 
                    class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded mb-4">
                    Logout
                </button>
                <div class="text-sm text-green-600">
                    Manage settings via Vercel Dashboard ‚Üí Environment Variables
                </div>
            </div>
            <button onclick="toggleAdmin()" 
                class="mt-4 text-green-400 hover:text-green-300">
                Close
            </button>
        </div>
    </div>

    <script>
        let sessionId = null;

        async function searchDatabase() {
            const phoneNumber = document.getElementById('phoneInput').value;
            if (!phoneNumber) {
                alert('Please enter a phone number');
                return;
            }

            document.getElementById('loading').classList.remove('hidden');
            document.getElementById('results').classList.add('hidden');

            try {
                const res = await fetch('/api/search', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ phoneNumber })
                });

                const data = await res.json();
                displayResults(data.results || []);
            } catch (error) {
                alert('Search failed: ' + error.message);
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.remove('hidden');
            
            if (!results.length) {
                resultsDiv.innerHTML = '<p class="text-green-400">No results found</p>';
                return;
            }

            let html = `<h2 class="text-xl font-bold text-green-400 mb-4">Results Found: ${results.length}</h2>`;
            results.forEach((r, i) => {
                html += `
                    <div class="bg-black/50 border border-green-600 rounded p-4 mb-4">
                        <h3 class="text-green-500 font-bold mb-2">${r.databaseName}</h3>
                        <p class="text-green-600 text-sm mb-2">${r.infoLeak}</p>
                        ${r.data.map(d => `<div class="text-green-400 text-sm">${d}</div>`).join('')}
                    </div>
                `;
            });
            resultsDiv.innerHTML = html;
        }

        function toggleAdmin() {
            const modal = document.getElementById('adminModal');
            modal.classList.toggle('hidden');
        }

        async function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            try {
                const res = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ password })
                });

                const data = await res.json();
                if (data.success) {
                    sessionId = data.sessionId;
                    document.getElementById('loginForm').classList.add('hidden');
                    document.getElementById('adminPanel').classList.remove('hidden');
                } else {
                    alert('Invalid password');
                }
            } catch (error) {
                alert('Login failed');
            }
        }

        function logout() {
            sessionId = null;
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('adminPanel').classList.add('hidden');
            document.getElementById('adminPassword').value = '';
        }
    </script>
</body>
</html>
